namespace = dvg_qingqiu_spain

# Tension on the Southern Border
dvg_qingqiu_spain.1 = {
	type = country_event
	placement = ROOT

	title = dvg_qingqiu_spain.1.t
	desc = dvg_qingqiu_spain.1.d
	flavor = dvg_qingqiu_spain.1.f
	
	event_image = {
		video = "southamerica_war_civilians"
	}

	on_created_soundeffect = "event:/SFX/UI/Alerts/event_appear"
	on_opened_soundeffect = "event:/SFX/Events/southamerica/war_civilians"

	icon = "gfx/interface/icons/event_icons/event_fire.dds"

	duration = 3

	immediate = {
		
	}
	trigger = {
		year = 1845
		OR = {
			AND = {
				exists = c:GCO
				c:GCO = {
					is_subject_of = c:SPA
				}
			}
			AND = {
				exists = c:LUS
				c:LUS = {
					is_subject_of = c:SPA
				}
			}
		}
		
		exists = c:SPA
		NOT = { has_global_variable = qq_spain_border_conflict_chain }
	}
	
	
	# I fear the Spanish will not be that considerate
	option = {
		name = dvg_qingqiu_spain.1.a
		default_option = yes
		
		c:SPA = {
			trigger_event = { id = dvg_qingqiu_spain.2 days = 7 }
		}
		set_global_variable = qq_spain_border_conflict_chain
		ai_chance = {
			base = 1
		}
	}
}
# Tension on the Southern Border
dvg_qingqiu_spain.2 = {
	type = country_event
	placement = ROOT

	title = dvg_qingqiu_spain.2.t
	desc = dvg_qingqiu_spain.2.d
	flavor = dvg_qingqiu_spain.2.f
	
	event_image = {
		video = "southamerica_war_civilians"
	}

	on_created_soundeffect = "event:/SFX/UI/Alerts/event_appear"
	on_opened_soundeffect = "event:/SFX/Events/southamerica/war_civilians"

	icon = "gfx/interface/icons/event_icons/event_fire.dds"

	duration = 3

	immediate = {
		
	}
	trigger = {
	}
	
	
	# Send the ultimatum
	option = {
		name = dvg_qingqiu_spain.2.a
		default_option = yes
		
		c:QIN = {
			trigger_event = { id = dvg_qingqiu_spain.3 days = 7 }
		}
		
		ai_chance = {
			base = 80
		}
	}
	# I fear the Spanish will not be that considerate
	option = {
		name = dvg_qingqiu_spain.2.b
		
		ai_chance = {
			base = 20
		}
	}
}
# The Spanish Ultimatum
dvg_qingqiu_spain.3 = {
	type = country_event
	placement = ROOT

	title = dvg_qingqiu_spain.3.t
	desc = dvg_qingqiu_spain.3.d
	flavor = dvg_qingqiu_spain.3.f
	
	event_image = {
		video = "southamerica_war_civilians"
	}

	on_created_soundeffect = "event:/SFX/UI/Alerts/event_appear"
	on_opened_soundeffect = "event:/SFX/Events/southamerica/war_civilians"

	icon = "gfx/interface/icons/event_icons/event_fire.dds"

	duration = 3

	immediate = {
		
	}
	trigger = {
	}
	
	
	# Begin the Great Diplomatic offensive on equal terms
	option = {
		name = dvg_qingqiu_spain.3.a
		default_option = yes
		c:SPA = {
			trigger_event = { id = dvg_qingqiu_spain.7 days = 45 }
		}
		c:PLA = {
			trigger_event = { id = dvg_qingqiu_spain.4 }
		}
		if = {
			limit = { exists = c:TWT }
			c:TWT = {
				trigger_event = { id = dvg_qingqiu_spain.4 }
			}
		}
		
		c:SCA = {
			trigger_event = { id = dvg_qingqiu_spain.5 }
		}
		ai_chance = {
			base = 50
			modifier = {
				trigger = { 
					c:SPA = { is_player = yes }
				}
				add = -50
			}
		}
	}
	# Offer the concessions to Scandinavia, and reach out to the others as well
	option = {
		name = dvg_qingqiu_spain.3.b
		c:SPA = {
			trigger_event = { id = dvg_qingqiu_spain.7 days = 45 }
		}
		c:PLA = {
			trigger_event = { id = dvg_qingqiu_spain.4 }
		}
		if = {
			limit = { exists = c:TWT }
			c:TWT = {
				trigger_event = { id = dvg_qingqiu_spain.4 }
			}
		}
		c:SCA = {
			trigger_event = { id = dvg_qingqiu_spain.6 }
		}
		ai_chance = {
			base = 50
			modifier = {
				trigger = { 
					c:SPA = { is_player = yes }
				}
				add = 50
			}
		}
	}
}
# QIN asks for aid - PLA and TWT
dvg_qingqiu_spain.4 = {
	type = country_event
	placement = ROOT

	title = dvg_qingqiu_spain.4.t
	desc = dvg_qingqiu_spain.4.d
	flavor = dvg_qingqiu_spain.4.f
	
	event_image = {
		video = "southamerica_war_civilians"
	}

	on_created_soundeffect = "event:/SFX/UI/Alerts/event_appear"
	on_opened_soundeffect = "event:/SFX/Events/southamerica/war_civilians"

	icon = "gfx/interface/icons/event_icons/event_fire.dds"

	duration = 3

	immediate = {
		
	}
	trigger = {
	}
	
	
	# Accept the alliance
	option = {
		name = dvg_qingqiu_spain.4.a
		default_option = yes
		
		change_relations = {
			country = c:QIN
			value = 150
		}
		if = {
			limit = {
				NOT = {
					any_scope_treaty = {
						binds = c:QIN
						any_scope_article = {
							has_type = alliance
						}
					}
				}
			}
			create_treaty = {
				first_country = root
				second_country = c:QIN

				is_draft = no
				binding_period = { years = 5 }

				articles_to_create = {
					{
						article = alliance
					}
				}
			}
		}
		ai_chance = {
			base = 50
			modifier = {
				trigger = { this ?= c:PLA }
				add = -25
			}
			modifier = {
				trigger = { this ?= c:TWT }
				add = 50
			}
		}
	}
	# Refuse the alliance
	option = {
		name = dvg_qingqiu_spain.4.b
		
		change_relations = {
			country = c:QIN
			value = -50
		}
		
		ai_chance = {
			base = 50
			modifier = {
				trigger = { this ?= c:PLA }
				add = 25
			}
			modifier = {
				trigger = { this ?= c:TWT }
				add = -50
			}
		}
	}
}
# QIN asks for aid - SCA
dvg_qingqiu_spain.5 = {
	type = country_event
	placement = ROOT

	title = dvg_qingqiu_spain.5.t
	desc = dvg_qingqiu_spain.5.d
	flavor = dvg_qingqiu_spain.5.f
	
	event_image = {
		video = "southamerica_war_civilians"
	}

	on_created_soundeffect = "event:/SFX/UI/Alerts/event_appear"
	on_opened_soundeffect = "event:/SFX/Events/southamerica/war_civilians"

	icon = "gfx/interface/icons/event_icons/event_fire.dds"

	duration = 3

	immediate = {
		
	}
	trigger = {
	}
	
	
	# Yeah they need to be knocked down a peg
	option = {
		name = dvg_qingqiu_spain.5.a
		default_option = yes
		
		change_relations = {
			country = c:QIN
			value = 150
		}
		if = {
			limit = {
				NOT = {
					any_scope_treaty = {
						binds = c:QIN
						any_scope_article = {
							has_type = alliance
						}
					}
				}
			}
			create_treaty = {
				first_country = root
				second_country = c:QIN

				is_draft = no
				binding_period = { years = 5 }

				articles_to_create = {
					{
						article = alliance
					}
				}
			}
		}
		
		ai_chance = {
			base = 40
		}
	}
	# We do not care for what Spain does in the New World
	option = {
		name = dvg_qingqiu_spain.5.b
		
		change_relations = {
			country = c:QIN
			value = -50
		}
		
		ai_chance = {
			base = 60
		}
	}
}
# QIN asks for aid - SCA with concessions
dvg_qingqiu_spain.6 = {
	type = country_event
	placement = ROOT

	title = dvg_qingqiu_spain.6.t
	desc = dvg_qingqiu_spain.6.d
	flavor = dvg_qingqiu_spain.6.f
	
	event_image = {
		video = "southamerica_war_civilians"
	}

	on_created_soundeffect = "event:/SFX/UI/Alerts/event_appear"
	on_opened_soundeffect = "event:/SFX/Events/southamerica/war_civilians"

	icon = "gfx/interface/icons/event_icons/event_fire.dds"

	duration = 3

	immediate = {
		
	}
	trigger = {
	}
	
	
	# You’re too kind Qingqiu of course we accept
	option = {
		name = dvg_qingqiu_spain.6.a
		default_option = yes
		
		change_relations = {
			country = c:QIN
			value = 150
		}
		if = {
			limit = {
				NOT = {
					any_scope_treaty = {
						binds = c:QIN
						any_scope_article = {
							has_type = alliance
						}
					}
				}
			}
			create_treaty = {
				first_country = root
				second_country = c:QIN

				is_draft = no
				binding_period = { years = 5 }

				articles_to_create = {
					{
						article = alliance
					}
				}
			}
		}
		
		ai_chance = {
			base = 99
		}
	}
	# We do not care for what Spain does in the New World
	option = {
		name = dvg_qingqiu_spain.6.b
		
		change_relations = {
			country = c:QIN
			value = -50
		}
		
		ai_chance = {
			base = 1
		}
	}
}
# Third Spanish Californian War
dvg_qingqiu_spain.7 = {
	type = country_event
	placement = ROOT

	title = dvg_qingqiu_spain.7.t
	desc = dvg_qingqiu_spain.7.d
	flavor = dvg_qingqiu_spain.7.f
	
	event_image = {
		video = "europenorthamerica_before_the_battle"
	}

	on_created_soundeffect = "event:/SFX/UI/Alerts/event_appear"
	on_opened_soundeffect = "event:/SFX/Events/europenorthamerica/before_the_battle"

	icon = "gfx/interface/icons/event_icons/event_fire.dds"

	duration = 3

	immediate = {
		s:STATE_XINGTIAN = { add_claim = ROOT }
		s:STATE_JINSHAN = { add_claim = ROOT }
		s:STATE_YICHENG = { add_claim = ROOT }
		every_country = {
			limit = { owns_entire_state_region = STATE_BAJA_CALIFORNIA }
			save_scope_as = dvg_california_owner
		}
		random_scope_state = {
			limit = { state_region = s:STATE_BAJA_CALIFORNIA }
			save_scope_as = california_state
		}
	}
	trigger = {
	}
	
	
	# This century old humiliation will at last be avenged.
	option = {
		name = dvg_qingqiu_spain.7.a
		default_option = yes
		
		create_diplomatic_play = {
			name = third_spanish_californian_war
			war = yes
			target_country = c:QIN
			target_state = s:STATE_XINGTIAN.region_state:QIN
			type = dp_return_state
			
			add_war_goal = {
				holder = c:SPA
				target_country = c:NVJ
				target_state = s:STATE_JINSHAN.region_state:NVJ
				type = return_state
			}
			add_war_goal = {
				holder = c:SPA
				target_country = c:UTE
				target_state = s:STATE_YICHENG.region_state:UTE
				type = return_state
			}
			add_war_goal = {
				holder = c:QIN
				target_country = c:SPA
				target_state = s:STATE_XINGTIAN.region_state:QIN
				type = revoke_claim
			}
			add_war_goal = {
				holder = c:QIN
				target_country = scope:dvg_california_owner
				target_state = scope:california_state
				type = return_state
			}
			add_war_goal = {
				holder = c:NVJ
				target_country = c:SPA
				target_state = s:STATE_JINSHAN.region_state:NVJ
				type = revoke_claim
			}
			add_war_goal = {
				holder = c:UTE
				target_country = c:SPA
				target_state = s:STATE_YICHENG.region_state:UTE
				type = revoke_claim
			}
		}
		c:QIN = {
			add_journal_entry = {
				type = je_californian_border_war
			}
		}
		ai_chance = {
			base = 1
		}
	}
}
# Treaty of Veracuz - QIN dissolution
dvg_qingqiu_spain.8 = {
	type = country_event
	placement = ROOT

	title = dvg_qingqiu_spain.8.t
	desc = dvg_qingqiu_spain.8.d
	flavor = dvg_qingqiu_spain.8.f
	
	event_image = {
		video = "southamerica_war_civilians"
	}

	on_created_soundeffect = "event:/SFX/UI/Alerts/event_appear"
	on_opened_soundeffect = "event:/SFX/Events/southamerica/war_civilians"

	icon = "gfx/interface/icons/event_icons/event_fire.dds"

	duration = 3

	immediate = {
	}
	trigger = {
	}
	
	
	# This is it, this is the end…
	option = {
		name = dvg_qingqiu_spain.8.a
		default_option = yes
		
		create_country = {
			tag = BYO
			origin = this
			state = s:STATE_XIAOSU.region_state:QIN
			state = s:STATE_QIZHOU.region_state:QIN
			state = s:STATE_HEICHI.region_state:QIN
		}
		
		if = {
			limit = {
				exists = c:GCO
				c:GCO = { is_subject_of = c:SPA }
			}
			c:GCO = {
				trigger_event = { id = dvg_qingqiu_spain.9 }
			}
		}
		else = {
			limit = {
				exists = c:LUS
				c:LUS = { is_subject_of = c:SPA }
			}
			c:LUS = {
				trigger_event = { id = dvg_qingqiu_spain.9 }
			}
		}
		ai_chance = {
			base = 1
		}
	}
}
# Treaty of Veracuz - GCO/LUS getting lands from SPA
dvg_qingqiu_spain.9 = {
	type = country_event
	placement = ROOT

	title = dvg_qingqiu_spain.9.t
	desc = dvg_qingqiu_spain.9.d
	flavor = dvg_qingqiu_spain.9.f
	
	event_image = {
		video = "southamerica_aristocrats"
	}

	on_created_soundeffect = "event:/SFX/UI/Alerts/event_appear"
	on_opened_soundeffect = "event:/SFX/Events/southamerica/aristocrats"

	icon = "gfx/interface/icons/event_icons/event_fire.dds"

	duration = 3

	immediate = {
	}
	trigger = {
	}
	
	
	# Praise the Lord!
	option = {
		name = dvg_qingqiu_spain.9.a
		default_option = yes
		
		if = {
			limit = {
				exists = c:GCO
				c:GCO = { is_subject_of = c:SPA }
			}
			s:STATE_XINGTIAN.region_state:SPA = { set_state_owner = c:GCO }
			s:STATE_JINSHAN.region_state:SPA = { set_state_owner = c:GCO }
			s:STATE_YICHENG.region_state:SPA = { set_state_owner = c:GCO }
		}
		else = {
			limit = {
				exists = c:LUS
				c:LUS = { is_subject_of = c:SPA }
			}
			s:STATE_XINGTIAN.region_state:SPA = { set_state_owner = c:LUS }
			s:STATE_JINSHAN.region_state:SPA = { set_state_owner = c:LUS }
			s:STATE_YICHENG.region_state:SPA = { set_state_owner = c:LUS }
		}
		c:SPA = {
			trigger_event = { id = dvg_qingqiu_spain.10 }
		}
		add_liberty_desire = -10
		ai_chance = {
			base = 1
		}
	}
}
# Treaty of Veracuz - SPA event
dvg_qingqiu_spain.10 = {
	type = country_event
	placement = ROOT

	title = dvg_qingqiu_spain.10.t
	desc = dvg_qingqiu_spain.10.d
	flavor = dvg_qingqiu_spain.10.f
	
	event_image = {
		video = "votp_monarch_holding_court"
	}

	on_created_soundeffect = "event:/SFX/UI/Alerts/event_appear"
	on_opened_soundeffect = "event:/SFX/Events/votp/monarch_holding_court"

	icon = "gfx/interface/icons/event_icons/event_fire.dds"

	duration = 3

	immediate = {
	}
	trigger = {
	}
	
	
	# Plus Ultra!
	option = {
		name = dvg_qingqiu_spain.10.a
		default_option = yes
		
		ai_chance = {
			base = 1
		}
	}
}
# Treaty of Puerto del Rey - QQ victory
dvg_qingqiu_spain.11 = {
	type = country_event
	placement = ROOT

	title = dvg_qingqiu_spain.11.t
	desc = dvg_qingqiu_spain.11.d
	flavor = dvg_qingqiu_spain.11.f
	
	event_image = {
		video = "votp_monarch_holding_court"
	}

	on_created_soundeffect = "event:/SFX/UI/Alerts/event_appear"
	on_opened_soundeffect = "event:/SFX/Events/votp/monarch_holding_court"

	icon = "gfx/interface/icons/event_icons/event_fire.dds"

	duration = 3

	immediate = {
	}
	trigger = {
	}
	
	
	# Like Dom Quixote, just a foolish old man and his rusty lance.
	option = {
		name = dvg_qingqiu_spain.11.a
		default_option = yes
		
		if = {
			limit = { exists = c:GCO }
			c:GCO = {
				trigger_event = { id = dvg_qingqiu_spain.12 }
			}
		}
		else = {
			limit = { exists = c:LUS }
			c:SPA = {
				remove_diplomatic_pact = {
					country = c:LUS
					type = colony
				}
				remove_diplomatic_pact = {
					country = c:MEX
					type = colony
				}
			}
		}
		
		ai_chance = {
			base = 1
		}
	}
}
# Treaty of Puerto del Rey - GCO/LUS breaks free
dvg_qingqiu_spain.12 = {
	type = country_event
	placement = ROOT

	title = dvg_qingqiu_spain.12.t
	desc = dvg_qingqiu_spain.12.d
	flavor = dvg_qingqiu_spain.12.f
	
	event_image = {
		video = "southamerica_war_civilians"
	}

	on_created_soundeffect = "event:/SFX/UI/Alerts/event_appear"
	on_opened_soundeffect = "event:/SFX/Events/southamerica/war_civilians"

	icon = "gfx/interface/icons/event_icons/event_fire.dds"

	duration = 3

	immediate = {
	}
	trigger = {
	}
	
	
	# We are broken, but we are at least free.
	option = {
		name = dvg_qingqiu_spain.12.a
		default_option = yes
		
		c:SPA = {
			remove_diplomatic_pact = {
				country = this
				type = colony
			}
		}
		create_country = {
			tag = LUS
			origin = this
			
			state = s:STATE_BAHIA.region_state:GCO
			state = s:STATE_SANTA_CATARINA.region_state:GCO
			state = s:STATE_TEJAS.region_state:GCO
			state = s:STATE_RIO_GRANDE.region_state:GCO
			state = s:STATE_BAJA_CALIFORNIA.region_state:GCO
		}
		change_tag = MEX
		c:QIN = {
			trigger_event = { id = dvg_qingqiu_spain.13 }
		}
		ai_chance = {
			base = 1
		}
	}
}
# QIN celebration
dvg_qingqiu_spain.13 = {
	type = country_event
	placement = ROOT

	title = dvg_qingqiu_spain.13.t
	desc = dvg_qingqiu_spain.13.d
	flavor = dvg_qingqiu_spain.13.f
	
	event_image = {
		video = "votp_monarch_holding_court"
	}

	on_created_soundeffect = "event:/SFX/UI/Alerts/event_appear"
	on_opened_soundeffect = "event:/SFX/Events/votp/monarch_holding_court"

	icon = "gfx/interface/icons/event_icons/event_fire.dds"

	duration = 3

	immediate = {
	}
	trigger = {
	}
	
	
	# We did it! I can’t believe we did it!
	option = {
		name = dvg_qingqiu_spain.13.a
		default_option = yes
		
		ai_chance = {
			base = 1
		}
	}
}
# Treaty of Sanbao - White Peace
dvg_qingqiu_spain.14 = {
	type = country_event
	placement = ROOT

	title = dvg_qingqiu_spain.14.t
	desc = dvg_qingqiu_spain.14.d
	flavor = dvg_qingqiu_spain.14.f
	
	event_image = {
		video = "southamerica_war_civilians"
	}

	on_created_soundeffect = "event:/SFX/UI/Alerts/event_appear"
	on_opened_soundeffect = "event:/SFX/Events/southamerica/war_civilians"

	icon = "gfx/interface/icons/event_icons/event_fire.dds"

	duration = 3

	immediate = {
	}
	trigger = {
	}
	
	
	# At least we know we are equal to the powers of Europe.
	option = {
		name = dvg_qingqiu_spain.14.a
		default_option = yes
		
		ai_chance = {
			base = 1
		}
	}
}