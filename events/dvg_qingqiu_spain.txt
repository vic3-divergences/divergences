namespace = dvg_qingqiu_spain

# Tension on the Southern Border
dvg_qingqiu_spain.1 = {
	type = country_event
	placement = ROOT

	title = dvg_qingqiu_spain.1.t
	desc = dvg_qingqiu_spain.1.d
	flavor = dvg_qingqiu_spain.1.f
	
	event_image = {
		video = "southamerica_war_civilians"
	}

	on_created_soundeffect = "event:/SFX/UI/Alerts/event_appear"
	on_opened_soundeffect = "event:/SFX/Events/southamerica/war_civilians"

	icon = "gfx/interface/icons/event_icons/event_fire.dds"

	duration = 3

	immediate = {
		
	}
	trigger = {
		year = 1845
		OR = {
			AND = {
				exists = c:GCO
				c:GCO = {
					is_subject_of = c:SPA
				}
			}
			AND = {
				exists = c:LUS
				c:LUS = {
					is_subject_of = c:SPA
				}
			}
		}
		
		exists = c:SPA
		NOT = { has_global_variable = qq_spain_border_conflict_chain }
	}
	
	
	# I fear the Spanish will not be that considerate
	option = {
		name = dvg_qingqiu_spain.1.a
		default_option = yes
		
		c:SPA = {
			trigger_event = { id = dvg_qingqiu_spain.2 days = 7 }
		}
		set_global_variable = qq_spain_border_conflict_chain
		ai_chance = {
			base = 1
		}
	}
}
# Tension on the Southern Border
dvg_qingqiu_spain.2 = {
	type = country_event
	placement = ROOT

	title = dvg_qingqiu_spain.2.t
	desc = dvg_qingqiu_spain.2.d
	flavor = dvg_qingqiu_spain.2.f
	
	event_image = {
		video = "southamerica_war_civilians"
	}

	on_created_soundeffect = "event:/SFX/UI/Alerts/event_appear"
	on_opened_soundeffect = "event:/SFX/Events/southamerica/war_civilians"

	icon = "gfx/interface/icons/event_icons/event_fire.dds"

	duration = 3

	immediate = {
		
	}
	trigger = {
	}
	
	
	# Send the ultimatum
	option = {
		name = dvg_qingqiu_spain.2.a
		default_option = yes
		
		c:QIN = {
			trigger_event = { id = dvg_qingqiu_spain.3 days = 7 }
		}
		
		ai_chance = {
			base = 80
		}
	}
	# I fear the Spanish will not be that considerate
	option = {
		name = dvg_qingqiu_spain.2.b
		
		ai_chance = {
			base = 20
		}
	}
}
# The Spanish Ultimatum
dvg_qingqiu_spain.3 = {
	type = country_event
	placement = ROOT

	title = dvg_qingqiu_spain.3.t
	desc = dvg_qingqiu_spain.3.d
	flavor = dvg_qingqiu_spain.3.f
	
	event_image = {
		video = "southamerica_war_civilians"
	}

	on_created_soundeffect = "event:/SFX/UI/Alerts/event_appear"
	on_opened_soundeffect = "event:/SFX/Events/southamerica/war_civilians"

	icon = "gfx/interface/icons/event_icons/event_fire.dds"

	duration = 3

	immediate = {
		
	}
	trigger = {
	}
	
	
	# Begin the Great Diplomatic offensive on equal terms
	option = {
		name = dvg_qingqiu_spain.3.a
		default_option = yes
		c:SPA = {
			trigger_event = { id = dvg_qingqiu_spain.7 days = 45 }
		}
		c:PLA = {
			trigger_event = { id = dvg_qingqiu_spain.4 }
		}
		if = {
			limit = { exists = c:TWT }
			c:TWT = {
				trigger_event = { id = dvg_qingqiu_spain.4 }
			}
		}
		
		c:SCA = {
			trigger_event = { id = dvg_qingqiu_spain.5 }
		}
		ai_chance = {
			base = 50
			modifier = {
				limit = { 
					c:SPA = { is_player = yes }
				}
				add = -50
			}
		}
	}
	# Offer the concessions to Scandinavia, and reach out to the others as well
	option = {
		name = dvg_qingqiu_spain.3.b
		c:SPA = {
			trigger_event = { id = dvg_qingqiu_spain.7 days = 45 }
		}
		c:PLA = {
			trigger_event = { id = dvg_qingqiu_spain.4 }
		}
		if = {
			limit = { exists = c:TWT }
			c:TWT = {
				trigger_event = { id = dvg_qingqiu_spain.4 }
			}
		}
		c:SCA = {
			trigger_event = { id = dvg_qingqiu_spain.6 }
		}
		ai_chance = {
			base = 50
		}
	}
}
# QIN asks for aid - PLA and TWT
dvg_qingqiu_spain.4 = {
	type = country_event
	placement = ROOT

	title = dvg_qingqiu_spain.4.t
	desc = dvg_qingqiu_spain.4.d
	flavor = dvg_qingqiu_spain.4.f
	
	event_image = {
		video = "southamerica_war_civilians"
	}

	on_created_soundeffect = "event:/SFX/UI/Alerts/event_appear"
	on_opened_soundeffect = "event:/SFX/Events/southamerica/war_civilians"

	icon = "gfx/interface/icons/event_icons/event_fire.dds"

	duration = 3

	immediate = {
		
	}
	trigger = {
	}
	
	
	# Accept the alliance
	option = {
		name = dvg_qingqiu_spain.4.a
		default_option = yes
		
		change_relation = {
			country = c:QIN
			value = 150
		}
		if = {
			limit = {
				NOT = {
					any_scope_treaty = {
						binds = c:QIN
						any_scope_article = {
							has_type = alliance
						}
					}
				}
			}
			create_treaty = {
				first_country = root
				second_country = c:QIN

				is_draft = no
				binding_period = { years = 5 }

				articles_to_create = {
					{
						article = alliance
					}
				}
			}
		}
		ai_chance = {
			base = 50
			modifier = {
				limit = { this ?= c:PLA }
				add = -25
			}
			modifier = {
				limit = { this ?= c:TWT }
				add = 50
			}
		}
	}
	# Refuse the alliance
	option = {
		name = dvg_qingqiu_spain.4.b
		
		change_relation = {
			country = c:QIN
			value = -50
		}
		
		ai_chance = {
			base = 50
			modifier = {
				limit = { this ?= c:PLA }
				add = 25
			}
			modifier = {
				limit = { this ?= c:TWT }
				add = -50
			}
		}
	}
}
# QIN asks for aid - SCA
dvg_qingqiu_spain.5 = {
	type = country_event
	placement = ROOT

	title = dvg_qingqiu_spain.5.t
	desc = dvg_qingqiu_spain.5.d
	flavor = dvg_qingqiu_spain.5.f
	
	event_image = {
		video = "southamerica_war_civilians"
	}

	on_created_soundeffect = "event:/SFX/UI/Alerts/event_appear"
	on_opened_soundeffect = "event:/SFX/Events/southamerica/war_civilians"

	icon = "gfx/interface/icons/event_icons/event_fire.dds"

	duration = 3

	immediate = {
		
	}
	trigger = {
	}
	
	
	# Yeah they need to be knocked down a peg
	option = {
		name = dvg_qingqiu_spain.5.a
		default_option = yes
		
		change_relation = {
			country = c:QIN
			value = 150
		}
		if = {
			limit = {
				NOT = {
					any_scope_treaty = {
						binds = c:QIN
						any_scope_article = {
							has_type = alliance
						}
					}
				}
			}
			create_treaty = {
				first_country = root
				second_country = c:QIN

				is_draft = no
				binding_period = { years = 5 }

				articles_to_create = {
					{
						article = alliance
					}
				}
			}
		}
		
		ai_chance = {
			base = 40
		}
	}
	# We do not care for what Spain does in the New World
	option = {
		name = dvg_qingqiu_spain.5.b
		
		change_relation = {
			country = c:QIN
			value = -50
		}
		
		ai_chance = {
			base = 60
		}
	}
}
# QIN asks for aid - SCA with concessions
dvg_qingqiu_spain.6 = {
	type = country_event
	placement = ROOT

	title = dvg_qingqiu_spain.6.t
	desc = dvg_qingqiu_spain.6.d
	flavor = dvg_qingqiu_spain.6.f
	
	event_image = {
		video = "southamerica_war_civilians"
	}

	on_created_soundeffect = "event:/SFX/UI/Alerts/event_appear"
	on_opened_soundeffect = "event:/SFX/Events/southamerica/war_civilians"

	icon = "gfx/interface/icons/event_icons/event_fire.dds"

	duration = 3

	immediate = {
		
	}
	trigger = {
	}
	
	
	# You’re too kind Qingqiu of course we accept
	option = {
		name = dvg_qingqiu_spain.6.a
		default_option = yes
		
		change_relation = {
			country = c:QIN
			value = 150
		}
		if = {
			limit = {
				NOT = {
					any_scope_treaty = {
						binds = c:QIN
						any_scope_article = {
							has_type = alliance
						}
					}
				}
			}
			create_treaty = {
				first_country = root
				second_country = c:QIN

				is_draft = no
				binding_period = { years = 5 }

				articles_to_create = {
					{
						article = alliance
					}
				}
			}
		}
		
		ai_chance = {
			base = 99
		}
	}
	# We do not care for what Spain does in the New World
	option = {
		name = dvg_qingqiu_spain.6.b
		
		change_relation = {
			country = c:QIN
			value = -50
		}
		
		ai_chance = {
			base = 1
		}
	}
}
# Third Spanish Californian War
dvg_qingqiu_spain.7 = {
	type = country_event
	placement = ROOT

	title = dvg_qingqiu_spain.7.t
	desc = dvg_qingqiu_spain.7.d
	flavor = dvg_qingqiu_spain.7.f
	
	event_image = {
		video = "southamerica_war_civilians"
	}

	on_created_soundeffect = "event:/SFX/UI/Alerts/event_appear"
	on_opened_soundeffect = "event:/SFX/Events/southamerica/war_civilians"

	icon = "gfx/interface/icons/event_icons/event_fire.dds"

	duration = 3

	immediate = {
		s:STATE_XINGTIAN = { add_claim = ROOT }
		s:STATE_JINSHAN = { add_claim = ROOT }
		s:STATE_YICHENG = { add_claim = ROOT }
	}
	trigger = {
	}
	
	
	# This century old humiliation will at last be avenged.
	option = {
		name = dvg_qingqiu_spain.7.a
		default_option = yes
		
		create_diplomatic_play = {
			war = yes
			target_country = c:QIN
			target_state = s:STATE_XINGTIAN.region_state:QIN
			type = dp_return_state
			
			add_war_goal = {
				holder = c:SPA
				target_country = c:QIN
				target_state = s:STATE_JINSHAN.region_state:QIN
				type = return_state
			}
			add_war_goal = {
				holder = c:SPA
				target_country = c:QIN
				target_state = s:STATE_YICHENG.region_state:QIN
				type = return_state
			}
		}
		
		ai_chance = {
			base = 1
		}
	}
}