zhourao_migration_button = {
	name = zhourao_migration_button
	desc = zhourao_migration_button_desc

	visible = { always = yes }

	possible = {
		hidden_trigger = {
			has_variable = enable_zhr_migration_button
		}
		# Note that this closely reflects triggers in the event. Do not change one without changing both
		custom_tooltip = {
			text = migration_button_cooldown_tt
			NOT = { has_variable = zhr_migration_cooldown }
		}
		average_sol >= 10
		any_country = {
			country_rank <= rank_value:major_power
			custom_tooltip = {
				text = is_in_china_tt
				any_primary_culture = {
					has_discrimination_trait = tradition_sinosphere
				}
			}
			
			custom_tooltip = {
				text = average_sol_below_root_tt
				average_sol <= root.average_sol
			}
			any_primary_culture = {
				culture_can_have_mass_migration_to_country = ROOT
			}
			any_scope_state = {
				is_incorporated = yes
				custom_tooltip = {
					text = is_in_china_tt
					state_region = {
						is_homeland = cu:han
					}
				}
				count >= 3
			}
		}
		any_scope_state = {
			trigger_if = {
				limit = {
					owner = { has_journal_entry = je_zhourao_migration }
					is_incorporated = yes
					state_region = { is_homeland = cu:zhourao }
				}
			}
			
			is_incorporated = yes
			custom_tooltip = {
				text = mass_migration_target_tt
				is_mass_migration_target = no
			}
		}
		OR = {
			has_law = law_type:law_racial_segregation
			has_law = law_type:law_cultural_exclusion
			has_law = law_type:law_multicultural
		}
		NOR = {
			has_law = law_type:law_closed_borders
			has_law = law_type:law_isolationism
		}
	}

	effect = {
		set_variable = {
			name = zhr_migration_cooldown
			days = normal_modifier_time
		}
		custom_tooltip = {
			text = mass_migration_button_tt
		}
		trigger_event = { id = zhr_migration.1 popup = yes }
		show_as_tooltip = {
			add_modifier = {
				name = zhr_migration_cost
				days = normal_modifier_time
			}
		}
	}

	ai_chance = {
		value = 1
	}
}

qingqiu_migration_button = {
	name = qingqiu_migration_button
	desc = qingqiu_migration_button_desc

	visible = { always = yes }

	possible = {
		hidden_trigger = {
			has_variable = qingqiu_zhr_migration_button
		}
		# Note that this closely reflects triggers in the event. Do not change one without changing both
		custom_tooltip = {
			text = migration_button_cooldown_tt
			NOT = { has_variable = zhr_migration_cooldown }
		}
		average_sol >= 10
		any_country = {
			country_rank <= rank_value:major_power
			custom_tooltip = {
				text = is_in_china_tt
				any_primary_culture = {
					has_discrimination_trait = heritage_han
				}
			}
			
			custom_tooltip = {
				text = average_sol_below_root_tt
				average_sol <= root.average_sol
			}
			any_primary_culture = {
				culture_can_have_mass_migration_to_country = ROOT
			}
			any_scope_state = {
				is_incorporated = yes
				custom_tooltip = {
					text = is_in_china_tt
					state_region = {
						is_homeland = cu:han
					}
				}
				count >= 3
			}
		}
		any_scope_state = {
			trigger_if = {
				limit = {
					owner = { has_journal_entry = je_qingqiu_migration }
					is_incorporated = yes
					state_region = { is_homeland = cu:qingqiuan }
				}
			}
			
			is_incorporated = yes
			custom_tooltip = {
				text = mass_migration_target_tt
				is_mass_migration_target = no
			}
		}
		OR = {
			has_law = law_type:law_racial_segregation
			has_law = law_type:law_cultural_exclusion
			has_law = law_type:law_multicultural
		}
		NOR = {
			has_law = law_type:law_closed_borders
			has_law = law_type:law_isolationism
		}
	}

	effect = {
		set_variable = {
			name = zhr_migration_cooldown
			days = normal_modifier_time
		}
		custom_tooltip = {
			text = mass_migration_button_tt
		}
		trigger_event = { id = qingqiu_migration.1 popup = yes }
		show_as_tooltip = {
			add_modifier = {
				name = zhr_migration_cost
				days = normal_modifier_time
			}
		}
	}

	ai_chance = {
		value = 1
	}
}

dvg_pillger_prince_button = {
	name = "dvg_pillger_prince_button"
	desc = "dvg_pillger_prince_button_desc"

	visible = { always = yes }

	possible = {
		any_scope_character = {
			has_variable = pillager_prince
		}
		authority >= 300
		NOT = {has_law = law_type:law_guaranteed_liberties}
		OR = {
		NOT = {has_law = law_type:law_no_police}
		NOT = {has_law = law_type:law_no_home_affairs}
		
		}
		
	}
	effect = {
		set_variable = pillager_prince_expeller
		if = {
			limit = {
				any_scope_character = {
					has_variable = pillager_prince
				}
			}
			every_scope_character = {
				limit = {
					has_variable = pillager_prince

				}
				remove_trait = immortal
			}
		}
		if = {
			limit = {
				OR = {
					institution_investment_level = {
						institution = institution_police
						value = 1
					}
					institution_investment_level = {
						institution = institution_home_affairs
						value = 1
					}
				}
			}
			random_list = {
			

				2 = {
					random_scope_character = {
						limit = {
							has_variable = pillager_prince
						}
						kill_character = yes
						
					}
				}
				8 = {
					trigger_event = {
						id = dvg_zhourao.1205
					}
				}
			}
		}
		if = {
			limit = {
				OR = {
					institution_investment_level = {
						institution = institution_police
						value = 2
					}
					institution_investment_level = {
						institution = institution_home_affairs
						value = 2
					}
				}
			}
			random_list = {
			

				5 = {
					random_scope_character = {
						limit = {
							has_variable = pillager_prince
						}
						kill_character = yes
						
					}
				}
				5 = {
					trigger_event = {
						id = dvg_zhourao.1205
					}
				}
			}
		}
		if = {
			limit = {
				OR = {
					institution_investment_level = {
						institution = institution_police
						value >= 3
					}
					institution_investment_level = {
						institution = institution_home_affairs
						value >= 3
					}
				}
			}
			random_list = {
			

				8 = {
					random_scope_character = {
						limit = {
							has_variable = pillager_prince
						}
						kill_character = yes
						
					}
				}
				2 = {
					trigger_event = {
						id = dvg_zhourao.1205
					}
				}
			}
		}
		
		
	}
}

je_fang_hu_subject_appeal_to_qingqiu_button = {
	name = "je_fang_hu_subject_appeal_to_qingqiu_button"
	desc = "je_fang_hu_subject_appeal_to_qingqiu_button_desc"

	selected = {
		has_variable = FGH_appealed_to_QIN
	}

	visible = {
		exists = c:QIN
		exists = c:FGH
	}


	cooldown = { days = long_modifier_time }

	possible = {
		c:QIN ?= {
					relations:root > relations_threshold:cordial
		}
		NOR = {
			custom_tooltip = {
				text = opposes_rus_in_diplo_play_tt
				OR = {
					has_war_with = c:QIN
					is_diplomatic_play_enemy_of = c:QIN
				}
			}
			has_diplomatic_pact = {
				who = c:QIN
				type = rivalry
			}
		}
		any_scope_treaty = {
			count < 1
			OR = {
				binds = c:JAP
				binds = c:QIN
			}
			any_scope_article = {
				has_type = military_assistance
			}
		}
		
		
		custom_tooltip = {
			text = FGH_no_other_fang_hu_nation_appealing_rus_tt
			NOT = {
				any_diplomatically_relevant_country = {
					has_journal_entry = je_unify_fang_huistan
					NOT = {
						THIS = ROOT
					}
					OR = {
						has_variable = FGH_appealed_to_QIN
						AND = {
							has_variable = pending_aid_request
							var:pending_aid_request = c:QIN
						}
					}
				}
			}
		}
		custom_tooltip = {
			text = "can_create_treaty_MILITARY_ASSISTANCE"
			c:QIN ?= {
				can_create_treaty = {
					first_country = c:QIN
					second_country = ROOT

					is_draft = no
					binding_period = { years = 2 }

					articles_to_create = {
						{
							article = military_assistance
							source_country = c:QIN
							target_country = ROOT
						}
					}
				}
			}
		}
	}

	effect = {
		set_variable = { name = pending_aid_request value = c:QIN }
		save_scope_as = fang_hu_nation_scope
		c:QIN ?= {
			save_scope_as = relevant_country
			trigger_event = { id = dvg_hawaii.6 days = 7 popup = yes }
		}
		
	}

	ai_chance = {
		value = 0

		if = {
			limit = {
				c:QIN ?= {
					relations:root >= relations_threshold:cordial
				}
			}
			add = 15
		}

		if = {
			limit = {
				is_diplomatic_play_committed_participant = yes
			}
			add = 10
		}

		if = {
			limit = {
				has_variable = player_QIN_denied_aid_request
			}
			add = -1000
		}
	}
}
