je_bavarian_constitution = {
    icon = "gfx/interface/icons/invention_icons/pan_nationalism.dds"
    should_be_pinned_by_default = yes
    group = je_group_internal_affairs

    modifiers_while_active = { dvg_bav_draft_constitution }

    immediate = {
        set_variable = {
            name = je_bavarian_constitution_liberal_anger
            value = 0
        }

        trigger_event = {
            id = dvg_bavaria.2
            days = 120
        }

        trigger_event = {
            id = dvg_bavaria.5
            days = 30
        }

    }

    scripted_progress_bar = je_bavarian_constitution_liberal_anger_progress_bar

    on_monthly_pulse = {
        random_events = {
            130 = 0
            #10 = dvg_bavaria.5
            10 = dvg_bavaria.6
            10 = dvg_bavaria.7
            10 = dvg_bavaria.8
            10 = dvg_bavaria.9
            10 = dvg_bavaria.10
            10 = dvg_bavaria.11
        }
    }

    complete = {
        custom_tooltip = {
            text = je_bavarian_constitution_complete_tooltip
            has_variable = dvg_bavarian_constitution_complete
        }

    }

    on_complete = {
        trigger_event = dvg_bavaria.25
    }

    fail = {
        custom_tooltip = {
            text = je_bavarian_constitution_fail_tooltip
            var:je_bavarian_constitution_liberal_anger >= 5
        }
    }

    on_fail = {
        trigger_event = dvg_bavaria.26
    }

}



je_south_german_confederation_bav = {
    icon = "gfx/interface/icons/invention_icons/pan_nationalism.dds"
    should_be_pinned_by_default = yes
    group = je_group_foreign_affairs

    scripted_button = je_south_german_confederation_bav_scripted_button

    immediate = {
        c:AUS = {
            save_scope_as = scope_AUS
        }
        c:BAV = {
            save_scope_as = scope_BAV
        }

    }

    complete = {
        custom_tooltip = {
            text = je_bavarian_constitution_complete_tooltip
            has_variable = dvg_bavarian_constitution_complete
        }
        OR = {

            AND = {
                custom_tooltip = {
                    text = je_south_german_confederation_bav_austria_defeated_tooltip
                    NOT = { exists = c:AUS }
                }
                owns_entire_state_region = STATE_AUSTRIA
                owns_entire_state_region = STATE_STYRIA
            }

            c:AUS = { is_subject_of = root}

            custom_tooltip = {
                text = dvg_sgf_formed
                exists = c:SGF
                this = c:SGF
            }


        }


    }

    on_complete = {
        if = {
            limit = {
                exists = c:AGR
                OR = {
                    c:AGR = { is_subject_of = c:BAV}
                    c:AGR = { is_subject_of = c:AUS}
                }
            }
            annex_with_incorporation = c:AGR
        }

        if = {
            limit = {
                exists = c:SLZ
                OR = {
                    c:SLZ = { is_subject_of = c:BAV}
                    c:SLZ = { is_subject_of = c:AUS}
                }
            }
            annex_with_incorporation = c:SLZ
        }

        if = {
            limit = {
                exists = c:TRT
                OR = {
                    c:TRT = { is_subject_of = c:BAV}
                    c:TRT = { is_subject_of = c:AUS}
                }
            }
            annex_with_incorporation = c:TRT
        }

        if = {
            limit = {
                exists = c:AUS
                c:AUS = { is_subject_of = c:BAV }
            }
            annex_with_incorporation = c:AUS
        }

        c:BOH.power_bloc = {
            add_leverage = { target = c:BAV value = -1000 }
        }

        change_tag = SGF

        ##if = {
        ##    limit = {
        ##        c:AUS = {
        ##            has_journal_entry =
        ##        }
        ##    }
        ##}

        trigger_event = dvg_sgf.1

        

        decrease_hre_stability = yes

        hidden_effect = {
            decrease_hre_stability = yes
            decrease_hre_stability = yes
        }
    }

}