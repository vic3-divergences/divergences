je_atlantia_unite = {
	icon = "gfx/interface/icons/invention_icons/democracy.dds"
	
	group = je_group_foreign_affairs

	scripted_button = atlantia_subject_button

	scripted_button = atlantia_investment_button


	is_shown_when_inactive = {
		country_has_primary_culture = cu:atlantian
		country_rank > rank_value:insignificant_power 
	}

	possible = {
		is_subject = no
		NOT ={
			has_law = law_type:law_autocracy
			has_law = law_type:law_ethnostate
			has_law = law_type:law_command_economy
		}
		OR = {
			has_technology_researched = pan-nationalism
			has_technology_researched = joint_stock_companies
		}
		country_rank > rank_value:insignificant_power
	}
	
	complete = {
		has_technology_researched = pan-nationalism
		custom_tooltip = {
			text = ameriga_formed_tt
			exists = c:AME
			c:AME = ROOT
		}
		is_at_war = no
	}

	on_complete = {
		trigger_event = { id = dvg_ameriga.2 popup = yes }
		if = {
			limit = {
				has_modifier = dvg_atlantia_giving_support
			}
			remove_modifier = dvg_atlantia_giving_support
		}
	}
	weight = 100
	should_be_pinned_by_default = yes
}

je_atlantia_wild_card = {
	icon = "gfx/interface/icons/invention_icons/pan_nationalism.dds"
	
	group = je_group_foreign_affairs

	scripted_button = atlantia_agitation_button

	is_shown_when_inactive = {
		country_has_primary_culture = cu:atlantian
		OR = {
			c:LOT = {
				has_journal_entry = je_lotharian_house_of_cards
			}
			c:AMA = {
				has_journal_entry = je_equinoxea_insurgency
			}
		}
	}
	immediate = {
		
	}

	possible = {
		is_subject = no
		NOT ={
			has_law = law_type:law_autocracy
			has_law = law_type:law_ethnostate
			has_law = law_type:law_command_economy
		}
		has_technology_researched = nationalism
		has_law = law_type:law_secret_police
		is_player = yes
	}
	
	complete = {
		OR = {
			AND = {
				custom_tooltip = {
					text = ama_lot_existence_tt
					has_global_variable = lotharingia_shatters
					has_global_variable = amazonie_shatters
				}
			
			}
			AND = {
				custom_tooltip = {
					text = lot_existence_tt
					NOT = {
						exists = c:LOT
					}
				}
				custom_tooltip = {
					text = ama_existence_tt
					NOT = {
						exists = c:AMA
					}
				}

			}
		}
		
	}

	on_complete = {
		trigger_event = { id = dvg_ameriga.13 popup = yes }
		if = {
			limit = {
				has_modifier = dvg_atlantia_giving_support
			}
			remove_modifier = dvg_atlantia_giving_support
		}
	
	}
	invalid = {
		AND = {
			has_global_variable = lotharingia_shatters
			has_global_variable = amazonie_shatters
		}
	}
	weight = 100
	should_be_pinned_by_default = yes
}

je_ameriga = {
	icon = "gfx/interface/icons/event_icons/waving_flag.dds"

	group = je_group_historical_content

	is_shown_when_inactive = {
		has_technology_researched = nationalism
		OR = {
			country_has_primary_culture = cu:antarctican
			country_has_primary_culture = cu:atlantian
			country_has_primary_culture = cu:equinoxien
			country_has_primary_culture = cu:lotharian
			AND = {
				has_variable = bul_pursued_greater_yugoslavism
				country_has_primary_culture = cu:bulgarian
			}
		}
		OR = {
			is_subject = no
			aggressive_diplomatic_plays_permitted = yes
		}
		NOT = { has_variable = je_yugoslavia_happened }
		NOR = { # not Danubian State
			c:KUK ?= this
			c:HBE ?= this # https://media.tenor.com/Z16slmCnZFcAAAAM/stare-christian-bale.gif
			has_journal_entry = je_danubian_federation
		}
	}

	possible = {
		has_technology_researched = pan-nationalism
		is_subject = no
		OR = {
			country_has_primary_culture = cu:antarctican
			country_has_primary_culture = cu:atlantian
			country_has_primary_culture = cu:equinoxien
			country_has_primary_culture = cu:lotharian
			AND = {
				hidden_trigger = {
					has_variable = bul_pursued_greater_yugoslavism
				}
				country_has_primary_culture = cu:beornian
			}
		}
	}

	immediate = {
		root = {
			save_scope_as = root_country_scope
		}
		cu:antarctican = {
			save_scope_as = croatian_scope
		}
		cu:atlantian = {
			save_scope_as = atlantian_scope
		}
		cu:equinoxien = {
			save_scope_as = slovene_scope
		}
		cu:lotharian = {
			save_scope_as = lotharian_scope
		}
		set_variable = je_yugoslavia_is_active
		trigger_event = {
			id = dvg_ameriga.1
			popup = yes
		}
	}

	complete = {
		custom_tooltip = { # happens via major formables
			text = is_yugoslavia_tt
			c:YUG ?= this
		}
		government_legitimacy >= 50
		is_at_war = no
		custom_tooltip = {
            text = no_insurrectionary_movement_tt
            NOT = {
                any_political_movement = {
                    is_insurrectionary = yes
                }
            }
        }
	}

	on_monthly_pulse = {

	}

	on_complete = {
		hidden_effect = {
			set_variable = je_yugoslavia_happened
		}
		trigger_event = {
			id = dvg_ameriga.2
			days = 1
			popup = yes
		}
	}

	event_outcome_completed_desc = {
	     first_valid = {
	         triggered_desc = {
	             desc = event_effects_yugoslavia.2_tt
	         }
	     }
	}

	fail = {
		is_subject = yes
	}

	on_fail = {
		hidden_effect = {
			set_variable = {
				name = je_yugoslavia_happened
				days = long_modifier_time
			}
		}
		post_notification = yugoslavia_failed_message
	}

	invalid = {
		ROOT = {
			OR  = {
				NOR = {
					country_has_primary_culture = cu:antarctican
					country_has_primary_culture = cu:atlantian
					country_has_primary_culture = cu:equinoxien
					country_has_primary_culture = cu:lotharian
					country_has_primary_culture = cu:bulgarian
				}
				c:KUK ?= this
				has_journal_entry = je_danubian_federation
			}
		}
	}

	weight = 100

	can_revolution_inherit = yes
	should_be_pinned_by_default = yes
}
