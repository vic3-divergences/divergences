je_lotharian_house_of_cards = {
	icon = "gfx/interface/icons/event_icons/event_scales.dds"

	group = je_group_internal_affairs

	possible = {
		ig:ig_armed_forces = {
			is_in_government = yes
		}
	}

	immediate = {

		

	}

	scripted_progress_bar = de_aigle_progressbar
	on_monthly_pulse = {
		effect = {
			if = {
				limit = {
				NOT = {
					has_variable = benevolent_dictatorship
				}
				ruler = {
					popularity > 70
				}
				average_sol_for_culture = {
					target = cu:lotharian
					value > 11
				}
				}
				trigger_event = {
					id = dvg_lotharingia.3
				}
			}

			if = {
				limit = {
				NOT = {
					has_variable = white_lot_favored
				}		
				average_sol_for_culture = {
					target = cu:lotharian
					value < 8
				}
				}
				trigger_event = {
					id = dvg_lotharingia.31
				}
			}
		}
		random_events = {
		15 = dvg_lotharingia.26
		15 = dvg_lotharingia.28
		15 = dvg_lotharingia.15
		15 = dvg_lotharingia.35
     	15 = dvg_lotharingia.32
		15 = dvg_lotharingia.36

		}
		
	}

	complete = {
		# If-else clause to avoid errors because of missing variable before JE activates
		OR = {
			custom_tooltip = {
			text = je_lotharian_house_of_cards_goal
			scope:journal_entry ?= {
				"scripted_bar_progress(de_aigle_progressbar)" >= 100
			}
			}	
		}
		OR = {
			has_modifier = declared_bankruptcy
			any_scope_state = {
				is_capital = yes
				turmoil > 0.50
			}
			has_journal_entry = je_coup
			ig:ig_armed_forces = {
				is_powerful = yes
				ig_approval < -10
			}
			any_enemy_in_diplo_play = {
				count > 1
				OR = {
					country_has_primary_culture = cu:lotharian
					country_has_primary_culture = cu:atlantian
					country_has_primary_culture = cu:guarani
					country_has_primary_culture = cu:afro_amerigan
				}
			}
		}
		
		has_law = law_type:law_autocracy
	
	}
	
	on_complete = {
		#set_variable = house_of_cards_complete
		every_diplomatic_play = {
			limit = {
				initiator_is = ROOT
				
			}
			end_play = yes
		}
		trigger_event = {
			id = dvg_lotharingia.5
		}
	}
	
	fail = {
		OR = {
			ig:ig_armed_forces = {
				is_powerful = no
				is_in_government = no
			}
			AND = {
				var:aigle_var <= 0
				year >= 1846 
			}
			
			NOT = { has_law = law_type:law_presidential_republic
			        has_law = law_type:law_monarchy
			}
			NOT = { has_law = law_type:law_autocracy
			        has_law = law_type:law_monarchy
			}
		}
		
	}
	
	on_fail = {
		#set_variable = house_of_cards_complete
		trigger_event = {
			id = dvg_lotharingia.4
		}
		
	}

	
	
	timeout = 9125

	on_timeout = {
		trigger_event = {
			 id = dvg_lotharingia.2
		}
	}
	invalid = {
		NOT = {
			any_scope_character = {
				has_variable = chef_de_aigle_var
			}
		}
	}
	on_invalid = {
		trigger_event = {
			id = dvg_lotharingia.2
	   }

	}

	current_value = {
		value = root.var:aigle_var
	}

	goal_add_value = {
		value = 250
	}
	

	weight = 10000
	should_be_pinned_by_default = yes
}

je_reconquering_atlantia = {
	icon = "gfx/interface/icons/event_icons/event_military.dds"

	group = je_group_foreign_affairs

	immediate = {
		hidden_effect = {
			if = {
				limit = {
					exists = c:ATL
				}
				set_secret_goal = {
					country = c:ATL
					secret_goal = conquer
				}
			}
		}
	}

	possible = {
	    year >= 1840
		NOT = {
			owns_entire_state_region = STATE_COTE_DU_CAFE
		}
	}

	complete = {
		OR = {
			owns_entire_state_region = STATE_COTE_DU_CAFE
		}
	}

	on_complete = {
		change_variable = {
			name = aigle_var
			add = 10
		}
		trigger_event = { id = dvg_lotharingia.10 }
	}
	should_be_pinned_by_default = yes
}

je_reuniting_lotharingia = {
	icon = "gfx/interface/icons/invention_icons/nationalism.dds"

	group = je_group_internal_affairs

	is_shown_when_inactive = {
		exists = c:LOT
		this = c:LOT
        OR = {
	        exists = c:NEA
			exists = c:ODO
			exists = c:TGI
			exists = c:ATL
		}    
		AND = {
			exists = c:NEA
			any_neighbouring_state = {
				owner = c:NEA
			}
		}
		AND = {
			exists = c:ODO
			any_neighbouring_state = {
				owner = c:ODO
			}
		}
	}

	possible = {
		custom_tooltip = {	
		text = collapsed_lotharingia
			OR = {
				exists = c:NEA
				exists = c:ODO
				exists = c:TGI
				exists = c:ATL
			}
		}
	}
	
	complete = {
		is_at_war = no
		owns_entire_state_region = STATE_COTE_DU_CAFE
		owns_entire_state_region = STATE_LORRAINE_ATLANTIQUE
		owns_entire_state_region = STATE_LIBREVILLE
		owns_entire_state_region = STATE_NOUVELLE_ALSACE
		owns_entire_state_region = STATE_BRUXELLES_SUR_ODON
		owns_entire_state_region = STATE_SERMOISE_SUR_ODON
		owns_entire_state_region = STATE_CHACO_BOREAL
		owns_entire_state_region = STATE_BOURGOGNE_DU_SUD
		owns_entire_state_region = STATE_MARCHES_OUEST
	}
	
	on_complete = {
		trigger_event = { id = dvg_lotharingia.6 }
	}

	fail = {
		OR = {
			NOT = { 
				has_law = law_type:law_autocracy
				has_law = law_type:law_oligarchy
				has_law = law_type:law_landed_voting
			}
		}
	}

	on_fail = {
		trigger_event = { id = dvg_lotharingia.7 }
	}

	timeout = 4380

	on_timeout = {
		trigger_event = {
			 id = dvg_lotharingia.7
		}
	}

	weight = 10000
	should_be_pinned_by_default = yes
}

je_odonia_unite = {
	icon = "gfx/interface/icons/invention_icons/democracy.dds"

	group = je_group_internal_affairs

	is_shown_when_inactive = {
		exists = c:ODO
        exists = c:LOT
		is_subject = no
		NOT = {exists = global_var:odonia_puppet}
		
		has_state_in_state_region = STATE_BOURGOGNE_DU_SUD
		has_state_in_state_region = STATE_TRANSFLEUVE
		any_neighbouring_state = {
			owner = c:LOT
		}
	}

    possible = {
		has_state_in_state_region = STATE_BOURGOGNE_DU_SUD
		has_state_in_state_region = STATE_TRANSFLEUVE
		
		
		
		is_subject = no
	}

	complete = {
		NOT = { exists = c:LOT }
		is_at_war = no
		owns_entire_state_region = STATE_LORRAINE_ATLANTIQUE
		owns_entire_state_region = STATE_SERMOISE_SUR_ODON
		owns_entire_state_region = STATE_BOURGOGNE_DU_SUD
	}

    on_complete = {
		trigger_event = { id = dvg_lotharingia.8 popup = yes }
		trigger_event = {id = dvg_lotharingia.13 popup = yes days = 30}
		
    }

    timeout = 2380

	on_timeout = {
		#trigger_event = {
			#id = dvg_lotharingia.7
		#}
	}

	should_be_pinned_by_default = yes
}

je_guarani_unite = {
	icon = "gfx/interface/icons/invention_icons/pan_nationalism.dds"

	group = je_group_internal_affairs

	is_shown_when_inactive = {
		exists = c:TGI
		exists = c:LOT

		any_neighbouring_state = {
			owner = c:LOT
		}
		OR = {
			any_neighbouring_state = {
				owner = c:BEO
			}
		}
	}

    possible = {
		has_state_in_state_region = STATE_MARCHES_OUEST
	}

	complete = {
		is_at_war = no
		owns_entire_state_region = STATE_CHACO_BOREAL
		owns_entire_state_region = STATE_MARCHES_OUEST
		owns_entire_state_region = STATE_BRUXELLES_SUR_ODON
		owns_entire_state_region = STATE_GRAND_CHACO
	}

    on_complete = {
		trigger_event = { id = dvg_lotharingia.9 popup = yes }
		
    }

	should_be_pinned_by_default = yes
}

je_nouvelle_alsace = {
	icon = "gfx/interface/icons/invention_icons/civilizing_mission.dds"

	group = je_group_internal_affairs

	is_shown_when_inactive = {
		exists = c:NEA
		
		this = c:NEA
		
		
	}

    possible = {
		exists = c:NEA
		has_state_in_state_region = STATE_NOUVELLE_ALSACE
	}

	complete = {
		is_diplomatic_play_committed_participant = no
		
	}

    on_complete = {
		trigger_event = { id = dvg_lotharingia.11 popup = yes }
		
    }

	should_be_pinned_by_default = yes
}

je_anglo_lotharingia = {
	icon = "gfx/interface/icons/event_icons/event_scales.dds"

	group = je_group_foreign_affairs

	possible = {
		
	}
	immediate = {
		
		trigger_event = {
			id = dvg_lotharingia.10
		}

		if = {
			limit = {
				was_formed_from = BEO
			}
			
			cu:lotharian = {
				save_scope_as = primary_culture_scope
			}
		}
		if = {
			limit = {
				was_formed_from = LOT
			}
			cu:beornian = {
				save_scope_as = primary_culture_scope
			}
		}
		set_variable = {
				name = fervour_bar_var
				value = scope:primary_culture_scope.culture_current_fervor
		}

		
	}

	on_monthly_pulse = {
		
		effect = {
			if = {
				limit = {
					OR = {
						cu:lotharian = {
							culture_current_fervor > 40
						}
						cu:beornian = {
							culture_current_fervor > 49
						}
					}
				}
				trigger_event = {
					id = dvg_lotharingia.14
				}
			}
			
		}
	}

	fail = {
		OR = {
			cu:lotharian = {
							culture_current_fervor > 49
						}
			cu:beornian = {
							culture_current_fervor > 49
			}
		}
		NOR = {
			
			any_country = {
				OR = {
					country_has_primary_culture = cu:beornian
					country_has_primary_culture = cu:lotharian
				}
				has_truce_with = root
				NOT = {
					is_subject_of = ROOT
				}
			}
			
		}
	}
	
	on_fail = {
		#set_variable = blt_complete
		trigger_event = {
			id = dvg_lotharingia.14
		}
	}

	invalid = {
	
		NOT = {exists = c:BLT}
	}
	

	

	goal_add_value = {
		value = 50
	}

	weight = 10000
	should_be_pinned_by_default = yes
	timeout = 7300

	on_timeout = {
		trigger_event = {
			id = dvg_lotharingia.30
		}
	}
}

je_lotharian_awakening = {
	icon = "gfx/interface/icons/event_icons/event_military.dds"

	group = je_group_great_awakening

	is_shown_when_inactive = {
		country_is_in_south_america = yes
		country_has_primary_culture = cu:lotharian
	}
	possible = {
		any_neighbouring_state = {
			owner = {
				has_variable = beornian_awakening
			}
		}
	}

	immediate = {

		set_variable = beornian_awakening
	}
	
	progressbar = yes

	on_monthly_pulse = {
		random_events = {
			10 = dvg_lotharingia.25
		}
		effect = {
			if = {
				limit = {
					ig:ig_devout = {
					is_in_government = yes
					}
				}

				change_variable = {
				name = pc_var
				add = 1
				}
			}
			if = {
				limit = {
					ig:ig_devout = {
					ig_approval > 10
					}
				}
				change_variable = {
				name = pc_var
				add = 1
				}
			}
			if = {
				limit = {
					ig:ig_devout = {
					ig_approval < -10
					}
				}
				change_variable = {
				name = pc_var
				subtract = 1
				}
			}
			if = {
				limit = {
					ig:ig_devout = {
						is_in_government = no
					}
				}
				change_variable = {
				name = pc_var
				subtract = 1
				}
			}
		}
	}

	complete = {
		trigger_if = {
			scope:journal_entry = { is_goal_complete = yes }
		}
		ig:ig_devout = {
			is_in_government = yes
			ig_approval > 10
		}
	}
	
	goal_add_value = 100

	on_complete = {
		trigger_event = { id = dvg_lotharingia.22 }
	}
	should_be_pinned_by_default = yes

	fail = {
		ig:ig_devout = {
			is_in_government = no
			ig_approval < -10
			is_marginal = yes
		}
	}
	timeout = 7125

}


je_grand_chaco = {
	icon = "gfx/interface/icons/invention_icons/pan_nationalism.dds"

	group = je_group_foreign_affairs

	is_shown_when_inactive = {
		any_scope_state = {
			state_region = s:STATE_GRAND_CHACO
		}
	}
	immediate = {
		random_primary_culture = {
			limit = {
				
			}
			save_scope_as = primary_culture_scope
		}
	}

    possible = {
		NOT = {
			has_law = law_type:law_no_colonial_affairs
		}
		custom_tooltip = {
			text = edward_dead
			NOT = {
				c:BEO = {
					ruler = {
					has_variable = is_edward
					}
				}		
			}
		}
		has_technology_researched = nationalism
	}

	complete = {
		owns_entire_state_region = STATE_GRAND_CHACO
	}

    on_complete = {
		ruler = {
			add_modifier = sovereignty_defender
		}
		if = {
			limit = {
				any_neighbouring_state = {
					state_region = {
						is_homeland = scope:primary_culture_scope
					}
				}
			}
			s:STATE_GRAND_CHACO = {
			add_homeland = scope:primary_culture_scope
			}
		}
		
    }

	should_be_pinned_by_default = yes
}

