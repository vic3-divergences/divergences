je_dvg_silesia_boom = {
    icon = "gfx/interface/icons/invention_icons/prospecting_tech.dds"
    should_be_pinned_by_default = yes

    group = je_group_internal_affairs

    scripted_button = je_dvg_silesia_boom_expand_infrastructure


    immediate = {
        random_scope_state = {
			limit = {
				has_state_trait = state_trait_upper_silesia_coalfield

			}
			save_scope_as = silesia_state_scope
		}
    }

    complete = {
        country_or_subject_owns_entire_state_region = STATE_SILESIA

        custom_tooltip = {
            text = je_dvg_silesia_boom_expand_infrastructure_tooltip
            has_variable = je_dvg_silesia_boom_expand_infrastructure
            NOT = {
                has_variable = je_dvg_silesia_boom_expand_infrastructure_expanding
            }
        }
    
    }

    on_complete = {

        scope:silesia_state_scope.state_region = {
            remove_state_trait = state_trait_upper_silesia_coalfield
            add_state_trait = state_trait_upper_silesia_coalfield_expanded
        }

    }

}




### OLD

je_hungarian_crisis = {
    icon = "gfx/interface/icons/invention_icons/pan_nationalism.dds"
    should_be_pinned_by_default = yes

    group = je_group_crises

    scripted_button = je_hungarian_crisis_vote_BOH
    scripted_button = je_hungarian_crisis_vote_BRG

    immediate = {

        if = {
            limit = {
                this = c:BOH
            }

            set_global_variable = {
                name = je_hungarian_crisis_vote_hun_independence_var
                value = 0
            }

            set_global_variable = {
                name = je_hungarian_crisis_vote_hun_puppet_var
                value = 0
            }

            set_global_variable = {
                name = je_hungarian_crisis_months_to_go
                value = 6
            }

            c:BRG = { add_journal_entry = { type = je_hungarian_crisis} }
            c:SCA = { add_journal_entry = { type = je_hungarian_crisis} }
            c:DUA = { add_journal_entry = { type = je_hungarian_crisis} }
            c:POL = { add_journal_entry = { type = je_hungarian_crisis} }
            c:BAV = { add_journal_entry = { type = je_hungarian_crisis} }
            c:AUS = { add_journal_entry = { type = je_hungarian_crisis} }
            c:TUR = { add_journal_entry = { type = je_hungarian_crisis} }
            c:HUN = { add_journal_entry = { type = je_hungarian_crisis} }

        }




    }

    on_monthly_pulse = {
        effect = {
            if = {
                limit = {
                    global_var:je_hungarian_crisis_months_to_go > 0
                    c:BOH ?= this
                }

                change_global_variable = { name = je_hungarian_crisis_months_to_go subtract = 1 }
            }


            if = {
                limit = {
                    global_var:je_hungarian_crisis_months_to_go = 0
                    c:BOH ?= this
                }

                set_global_variable = je_hungarian_crisis_vote_complete


            }

            if = {
                limit = {
                    c:BOH ?= this
                    has_global_variable = je_hungarian_crisis_vote_complete
                    global_var:je_hungarian_crisis_vote_hun_independence_var > global_var:je_hungarian_crisis_vote_hun_puppet_var

                }

                trigger_event = dvg_hungary.8
            }
            else_if = {
                limit = {
                    c:BOH ?= this
                    has_global_variable = je_hungarian_crisis_vote_complete
                    global_var:je_hungarian_crisis_vote_hun_independence_var <= global_var:je_hungarian_crisis_vote_hun_puppet_var
                }
                trigger_event = dvg_hungary.10
            }
        }
    }


    complete = {
        custom_tooltip = {
            text = je_hungarian_crisis_vote_complete_tooltip
            has_global_variable = je_hungarian_crisis_vote_complete
        }

        custom_tooltip = {
            text = je_hungarian_crisis_vote_BRG_accepted_tooltip
            has_global_variable = je_hungarian_crisis_vote_BRG_accepted
        }

        custom_tooltip = {
            text = je_hungarian_crisis_vote_BOH_accepted_tooltip
            has_global_variable = je_hungarian_crisis_vote_BOH_accepted
        }
    }

    on_complete = {


        if = {
            limit = {
                global_var:je_hungarian_crisis_vote_hun_independence_var > global_var:je_hungarian_crisis_vote_hun_puppet_var
            }

            trigger_event = dvg_hungary.13
        }

        if = {
            limit = {
                global_var:je_hungarian_crisis_vote_hun_independence_var <= global_var:je_hungarian_crisis_vote_hun_puppet_var
            }
            trigger_event = dvg_hungary.12
        }


    }

    fail = {
        OR = {
            custom_tooltip = {
                text = je_hungarian_crisis_vote_rejected_tooltip
                has_global_variable = je_hungarian_crisis_vote_rejected
            }

            custom_tooltip = {
                text = je_hungarian_crisis_war_outcome_tooltip
                has_global_variable = je_hungarian_crisis_war_outcome
            }
        }


    }

    on_fail = {
        trigger_event = dvg_hungary.14
    }

}